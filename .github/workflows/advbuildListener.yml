name: advbuildListener
on:
  workflow_dispatch:
  # push:
  schedule:
    - cron: "30 */5 * * *"
jobs:
  advbuildListener:
    runs-on: windows-2019
    env:
      toJSON_github: ${{ toJSON(github) }}
      toJSON_secrets: ${{ toJSON(secrets) }}
    steps:
      - name: actions/checkout@v4
        uses: actions/checkout@v4
      - name: Decrypt oAESFile
        shell: bash
        run: |
          if [ -f "./oAESFile.js" ]; then 
            node ./oAESFile.js --de ${{ secrets.OAESFILE }} ./; 
            git log -1;
          fi
      - name: Display files
        if: ${{ always() }}
        shell: pwsh
        run: |
          tree /f /a
      - name: Execute msbuild@v2 by NodeJS
        shell: bash
        run: |
          node ./advListener.js --runAsChildFork
      - name: Display files
        if: ${{ always() }}
        shell: pwsh
        run: |
          tree /f /a
